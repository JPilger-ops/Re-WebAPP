<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Einstellungen</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="/style.css" />
  <style>
    /* Dezente, schlichte Seite nur für Bank/Kategorien */
    .page-stack { display: grid; gap: 16px; max-width: 1200px; }
    .soft-card { border-radius: 16px; box-shadow: 0 10px 28px rgba(0,0,0,0.04); border: 1px solid #e5e7eb; background: #fff; padding: 16px; }
    .section-title { font-size: 22px; font-weight: 700; margin: 0; }
    .pill { background: #f2f2f7; color: #111; border-radius: 999px; padding: 6px 12px; font-size: 12px; }
    .input-stack { display: grid; gap: 12px; }
    .two-col { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 12px; }
    .tiny-note { font-size: 12px; color: #6b7280; }
    .inline-buttons { display: flex; gap: 8px; flex-wrap: wrap; }
    .dropzone-clean { border: 1px dashed #cbd5e1; border-radius: 12px; padding: 14px; text-align: center; background: #f8fafc; cursor: pointer; transition: 150ms ease; }
    .dropzone-clean:hover { border-color: #a0aec0; background: #f1f5f9; }
    .spacer-8 { height: 8px; }
    .table-top { display: flex; justify-content: space-between; align-items: center; gap: 10px; flex-wrap: wrap; margin-bottom: 10px; }
  </style>
</head>
<body>
  <div class="app-shell">
    <aside class="sidebar">
      <div class="sidebar-title">Rechnungsapp</div>
      <nav class="sidebar-nav">
        <button class="nav-item" id="nav-dashboard">Dashboard</button>
        <button class="nav-item" id="nav-invoices">Rechnungsübersicht</button>
        <button class="nav-item" id="nav-create">Neue Rechnung</button>
        <button class="nav-item" id="nav-customers">Kundenverwaltung</button>
        <button id="nav-users" class="nav-item">Benutzerverwaltung</button>
        <button id="nav-account" class="nav-item">Account</button>
        <button id="nav-roles" class="nav-item">Rollenverwaltung</button>
        <button id="nav-categories" class="nav-item nav-item-active">Einstellungen</button>
        <button id="nav-logout" class="nav-item" style="color:#b20000;">Logout</button>
      </nav>
    </aside>

    <main class="main">
      <header class="topbar">
        <div>
          <div class="chip">Einstellungen</div>
          <h1 class="topbar-title">Bank & Kategorien</h1>
          <div class="muted">Passe Rechnungs-Fußzeile, SEPA-Daten und Kategorien zentral an.</div>
        </div>
      </header>

      <div class="page-stack">
        <section class="soft-card">
          <div class="inline-buttons" style="justify-content: space-between; align-items: flex-start;">
            <div>
              <div class="pill">Bankdaten</div>
              <h2 class="section-title">SEPA & Fußzeile</h2>
              <div class="muted">Wird im PDF und SEPA-QR-Code genutzt.</div>
            </div>
            <div class="inline-buttons">
              <button id="bank-reload" class="secondary-button small-btn">Zurücksetzen</button>
              <button id="bank-save" class="primary-button small-btn">Speichern</button>
            </div>
          </div>

          <div id="bank-error" class="error-box hidden"></div>
          <div id="bank-success" class="success-box hidden"></div>

          <div class="input-stack">
            <label class="input-label">Kontoinhaber</label>
            <input id="bank-holder" class="input" type="text" placeholder="z. B. Waldwirtschaft Heidekönig" />

            <label class="input-label">Bankname</label>
            <input id="bank-name" class="input" type="text" placeholder="z. B. VR-Bank Bonn Rhein-Sieg eG" />

            <div class="two-col">
              <div>
                <label class="input-label">IBAN</label>
                <input id="bank-iban" class="input" type="text" placeholder="DE00 0000 0000 0000 0000 00" />
              </div>
              <div>
                <label class="input-label">BIC</label>
                <input id="bank-bic" class="input" type="text" placeholder="GENODEXX" />
              </div>
            </div>
            <div class="tiny-note">Die Angaben werden automatisch in neue Rechnungen und den SEPA-QR-Code übernommen.</div>
          </div>
        </section>

        <section class="soft-card" style="display:flex; flex-direction:column; gap:16px;">
          <div>
            <div class="pill">Kategorien & Logos</div>
            <h2 class="section-title">Logos pflegen, Labels vergeben</h2>
          </div>

          <div id="error-box" class="error-box hidden"></div>
          <div id="cat-success" class="success-box hidden"></div>

          <!-- Neu anlegen -->
          <div class="cat-form">
            <div class="input-stack">
              <div class="pill" style="align-self:flex-start;">Neu anlegen</div>
              <div id="logo-dropzone" class="dropzone-clean">
                <input type="file" id="logo-file" accept=".png,.jpg,.jpeg,.svg" hidden />
                <div class="mini-title" style="margin-bottom:4px;">Logo hochladen</div>
                <div class="tiny-note">PNG, JPG oder SVG · max. 1.5 MB</div>
                <div class="spacer-8"></div>
                <div class="settings-note" id="logo-file-name">Keine Datei ausgewählt</div>
                <div class="spacer-8"></div>
                <button id="logo-file-btn" class="secondary-button small-btn" type="button">Datei auswählen</button>
                <div class="tiny-note" style="margin-top:6px;">Upload speichert sofort und taucht in der Liste auf.</div>
              </div>

              <div class="two-col">
                <div>
                  <label class="input-label">Key (z. B. GESELLSCHAFTEN)</label>
                  <input id="cat-key" class="input" type="text" />
                  <div class="tiny-note" id="cat-key-hint">Großbuchstaben/Unterstriche werden automatisch gesetzt.</div>
                </div>
                <div>
                  <label class="input-label">Label (Anzeige)</label>
                  <input id="cat-label" class="input" type="text" />
                  <div class="tiny-note">So erscheint die Kategorie in Rechnungen.</div>
                </div>
              </div>

              <div>
                <label class="input-label">Logo-Datei</label>
                <select id="cat-logo" class="input select-input">
                  <option value="" selected disabled>Logo auswählen...</option>
                </select>
                <div class="tiny-note">Dateiname aus <code>/public/logos/</code>. Upload fügt neue hinzu.</div>
              </div>

              <div style="display:flex; gap:10px; align-items:center;">
                <button id="cat-add" class="primary-button">Kategorie speichern</button>
                <div class="tiny-note">Speichern fügt die Kategorie unten hinzu.</div>
              </div>
            </div>
          </div>

          <!-- Bestehende Kategorien -->
          <div class="cat-table-card">
            <div class="table-top">
              <div>
                <div class="pill">Bestehende Kategorien</div>
                <div class="tiny-note">Werte direkt anpassen und je Zeile speichern.</div>
              </div>
              <div class="inline-buttons">
                <button id="cat-refresh" class="secondary-button small-btn">Neu laden</button>
              </div>
            </div>
            <div class="table-wrapper">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 18%;">Key</th>
                    <th>Label</th>
                    <th>Logo-Datei</th>
                    <th style="width: 90px;">Vorschau</th>
                    <th style="width: 180px;">Aktionen</th>
                  </tr>
                </thead>
                <tbody id="cat-body"></tbody>
              </table>
            </div>
          </div>
        </section>
      </div>
    </main>
  </div>

  <script src="/nav.js?v=3"></script>
  <script src="/categories.js?v=3"></script>
</body>
</html>
